{
  "hash": "15b8c264053fd48abe1f2710cf175426",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Logistic Regression: Model comparison + inference\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"2025-04-01\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[ðŸ”— STA 210 - Spring 2025](https://sta210-sp25.netlify.app)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs: \n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\n    include-before: [ '<script type=\"text/x-mathjax-config\">MathJax.Hub.Config({tex2jax: {enableAssistiveMml: false}});</script>']\n  html: \n    output-file: 20-logistic-inference-notes.html\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n\n\n\n## Announcements\n\n-   Next project milestone: Analysis and draft in April 14 lab\n\n-   Team Feedback (email from TEAMMATES) due Tuesday, April 8 at 11:59pm (check email)\n\n-   Statistics experience due April 15\n\n## Topics\n\n-   Comparing logistic regression models using\n\n    -   Drop-in-deviance test\n\n    -   AIC\n\n    -   BIC\n\n-   Inference for a single model coefficient\n\n## Computational setup\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(openintro)\nlibrary(knitr)\nlibrary(kableExtra)  # for table embellishments\nlibrary(Stat2Data)   # for empirical logit\n\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_bw(base_size = 20))\n```\n:::\n\n\n\n\n## Data: Risk of coronary heart disease {.midi}\n\nThis data set is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. We want to examine the relationship between various health characteristics and the risk of having heart disease.\n\n-   `high_risk`:\n\n    -   1: High risk of having heart disease in next 10 years\n    -   0: Not high risk of having heart disease in next 10 years\n\n-   `age`: Age at exam time (in years)\n\n-   `education`: 1 = Some High School, 2 = High School or GED, 3 = Some College or Vocational School, 4 = College\n\n-   `currentSmoker`: 0 = nonsmoker, 1 = smoker\n\n-   `totChol`: Total cholesterol (in mg/dL)\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n# Review: Drop-in-deviance test\n\n## Which model do we choose? {.midi}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n::::: columns\n::: {.column width=\"50%\"}\n<center>**Model 1**</center>\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|term           | estimate|\n|:--------------|--------:|\n|(Intercept)    |   -6.673|\n|age            |    0.082|\n|totChol        |    0.002|\n|currentSmoker1 |    0.443|\n\n\n:::\n:::\n\n\n\n:::\n\n::: {.column width=\"50%\"}\n<center>**Model 2**</center>\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|term           | estimate|\n|:--------------|--------:|\n|(Intercept)    |   -6.456|\n|age            |    0.080|\n|totChol        |    0.002|\n|currentSmoker1 |    0.445|\n|education2     |   -0.270|\n|education3     |   -0.232|\n|education4     |   -0.035|\n\n\n:::\n:::\n\n\n\n:::\n:::::\n\nWe will use the **Drop-in-deviance test** to compare the two models\n\n## Drop-in-deviance test {.midi}\n\n**Hypotheses**\n\n$$\n\\begin{aligned}\nH_0&: \\beta_{ed2} = \\beta_{ed3} = \\beta_{ed4} = 0 \\\\\nH_a&: \\text{ at least one }\\beta_j \\text{ is not } 0\n\\end{aligned}\n$$\n\n. . .\n\n**Test in R**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n## reduced and full models\nhigh_risk_fit_reduced <- glm(high_risk ~ age + totChol + currentSmoker,\n              data = heart_disease, family = \"binomial\")\n\nhigh_risk_fit_full <- glm(high_risk ~ age + totChol + currentSmoker +\n                            education,\n              data = heart_disease, family = \"binomial\")\n\n## drop-in-deviance test \nanova(high_risk_fit_reduced, high_risk_fit_full, test = \"Chisq\") |>\n  tidy() |> \n  kable(digits = 3)\n```\n:::\n\n\n\n\n## Drop-in-deviance test {.midi}\n\n**Hypotheses**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|term                                                  | df.residual| residual.deviance| df| deviance| p.value|\n|:-----------------------------------------------------|-----------:|-----------------:|--:|--------:|-------:|\n|high_risk ~ age + totChol + currentSmoker             |        4082|          3224.812| NA|       NA|      NA|\n|high_risk ~ age + totChol + currentSmoker + education |        4079|          3217.600|  3|    7.212|   0.065|\n\n\n:::\n:::\n\n\n\n\n# Model comparison using AIC and BIC\n\n## AIC & BIC\n\nEstimators of prediction error and *relative* quality of models:\n\n**Akaike's Information Criterion (AIC)**[^1]: $$AIC = -2\\log L + 2(p+1)$$\n\n[^1]: Akaike, Hirotugu. [\"A new look at the statistical model identification.\"](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=1100705) *IEEE transactions on automatic control* 19.6 (1974): 716-723.\n\n**Schwarz's Bayesian Information Criterion (BIC)**[^2]: $$ BIC = -2\\log L + \\log(n)\\times(p+1)$$\n\n[^2]: Schwarz, Gideon. [\"Estimating the dimension of a model.\"](https://projecteuclid.org/journalArticle/Download?urlId=10.1214%2Faos%2F1176344136) *The annals of statistics* (1978): 461-464.\n\n## AIC & BIC\n\n$$\n\\begin{aligned} \n& AIC = \\color{blue}{-2\\log L}  \\color{black}{+ 2(p+1)} \\\\\n& BIC = \\color{blue}{-2\\log L}  + \\color{black}{\\log(n)\\times(p+1)}\n\\end{aligned}\n$$\n\n. . .\n\n<br>\n\nFirst Term: Decreases as *p* increases\n\n## AIC & BIC\n\n$$\n\\begin{aligned} & AIC = -2\\log L  + \\color{blue}{2(p+1)} \\\\\n& BIC = -2\\log L + \\color{blue}{\\log(n)\\times(p+1)} \n\\end{aligned}\n$$\n\n<br>\n\nSecond term: Increases as *p* increases\n\n## Using AIC & BIC\n\n$$\n\\begin{aligned} & AIC = -2\\log L  + \\color{red}{2(p+1)} \\\\\n& BIC = -2 \\log L  + \\color{red}{\\log(n)\\times(p+1)} \n\\end{aligned}\n$$\n\n-   Choose model with the smaller value of AIC or BIC\n\n-   If $n \\geq 8$, the **penalty** for BIC is larger than that of AIC, so BIC tends to favor *more parsimonious* models (i.e. models with fewer terms)\n\n## AIC from the `glance()` function\n\nLet's look at the AIC for the model that includes `age`, `totChol`, and `currentSmoker`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(high_risk_fit)$AIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3232.812\n```\n\n\n:::\n:::\n\n\n\n\n<br>\n\n. . .\n\n**Calculating AIC**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n- 2 * glance(high_risk_fit)$logLik + 2 * (3 + 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3232.812\n```\n\n\n:::\n:::\n\n\n\n\n## Comparing the models using AIC\n\nLet's compare the full and reduced models using AIC.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(high_risk_fit_reduced)$AIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3232.812\n```\n\n\n:::\n\n```{.r .cell-code}\nglance(high_risk_fit_full)$AIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3231.6\n```\n\n\n:::\n:::\n\n\n\n\n<br>\n\n::: question\nBased on AIC, which model would you choose?\n:::\n\n## Comparing the models using BIC\n\nLet's compare the full and reduced models using BIC\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglance(high_risk_fit_reduced)$BIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3258.074\n```\n\n\n:::\n\n```{.r .cell-code}\nglance(high_risk_fit_full)$BIC\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3275.807\n```\n\n\n:::\n:::\n\n\n\n\n<br>\n\n::: question\nBased on BIC, which model would you choose?\n:::\n\n# Application exercise\n\n::: appex\nðŸ“‹ [sta210-sp25.netlify.app/ae/ae-10-logistic-compare.html](../ae/ae-10-logistic-compare.html)\n:::\n\n# Estimating coefficients\n\n## Statistical model {.midi}\n\nThe form of the statistical model for logistic regression is\n\n$$\n\\log\\Big(\\frac{\\pi}{1-\\pi}\\Big) = \\beta_0 + \\beta_1X_1 + \\beta_2X_2 + \\dots + \\beta_pX_p\n$$\n\nwhere $\\pi$ is the probability $Y = 1$.\n\n. . .\n\nNotice there is no error term when writing the statistical model for logistic regression. Why?\n\n::: incremental\n-   Recall that the statistical model is the \"data-generating\" model\n-   Each individual observed $Y$ is generated from a Bernoulli distribution, $Bernoulli(\\pi)$ (similarly we can think of $n$ observed $Y$'s as generated from a Binomial distribution, $Binomial(n,p)$)\n-   Therefore, the randomness is not produced by an error term but rather in the distribution used to generate $Y$\n:::\n\n## Estimating coefficients {.midi}\n\nRecall the log likelihood function\n\n$$\n\\log L = \\sum\\limits_{i=1}^n[y_i \\log(\\hat{\\pi}_i) + (1 - y_i)\\log(1 - \\hat{\\pi}_i)]\n$$\n\nwhere\n\n$\\hat{\\pi} = \\frac{exp\\{\\hat{\\beta}_0 + \\hat{\\beta}_1X_1 + \\dots + \\hat{\\beta}_pX_p\\}}{1 + exp\\{\\hat{\\beta}_0 + \\hat{\\beta}_1X_1 + \\dots + \\hat{\\beta}_pX_p\\}}$\n\n. . .\n\n-   The coefficients $\\hat{\\beta}_0, \\ldots, \\hat{\\beta}_p$ are estimated using maximum likelihood estimation\n\n-   Basic idea: Find the values of $\\hat{\\beta}_0, \\ldots, \\hat{\\beta}_p$ that give the observed data the maximum probability of occurring\n\n## Iterative model fitting in R\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhigh_risk_fit_full <- glm(high_risk ~ age + totChol + currentSmoker,\n                          data = heart_disease, family = \"binomial\", \n                          # print each iteration\n                        control = glm.control(trace = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTracing glm.fit(x = structure(c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  .... on entry \nDeviance = 3268.418 Iterations - 1\nNULL\nDeviance = 3225.648 Iterations - 2\n[1] -4.4798060788  0.0496514919  0.0008626177  0.2457937103\nDeviance = 3224.813 Iterations - 3\n[1] -6.394448772  0.078826360  0.001808306  0.417970457\nDeviance = 3224.812 Iterations - 4\n[1] -6.665531647  0.082366229  0.001992166  0.442315330\nDeviance = 3224.812 Iterations - 5\n[1] -6.673085394  0.082464718  0.001997547  0.442980128\n```\n\n\n:::\n\n```{.r .cell-code}\n#stop printing for future models\nuntrace(glm.fit)\n```\n:::\n\n\n\n\n# Inference for coefficients\n\n## Inference for coefficients\n\nThere are two approaches for testing coefficients in logistic regression\n\n-   **Drop-in-deviance test**. Use to test...\n\n    -   a single coefficient\n    -   a categorical predictor with 3+ levels\n    -   a group of predictor variables\n\n-   **(Wald) hypothesis test.** Use to test\n\n    -   a single coefficient\n\n## Hypothesis test for $\\beta_j$\n\n**Hypotheses:** $H_0: \\beta_j = 0 \\hspace{2mm} \\text{ vs } \\hspace{2mm} H_a: \\beta_j \\neq 0$, given the other variables in the model\n\n. . .\n\n**(Wald) Test Statistic:** $$z = \\frac{\\hat{\\beta}_j - 0}{SE(\\hat{\\beta}_j)}$$\n\n. . .\n\n**P-value:** $P(|Z| > |z|)$, where $Z \\sim N(0, 1)$, the Standard Normal distribution\n\n## Confidence interval for $\\beta_j$\n\nWe can calculate the **C% confidence interval** for $\\beta_j$ as the following:\n\n$$\n\\hat{\\beta}_j \\pm z^* \\times SE(\\hat{\\beta}_j)\n$$\n\nwhere $z^*$ is calculated from the $N(0,1)$ distribution\n\n. . .\n\n::: callout-note\nThis is an interval for the change in the log-odds for every one unit increase in $x_j$\n:::\n\n## Interpretation in terms of the odds\n\nThe change in **odds** for every one unit increase in $x_j$.\n\n$$\n\\exp\\{\\hat{\\beta}_j \\pm z^* \\times SE(\\hat{\\beta}_j)\\}\n$$\n\n. . .\n\n**Interpretation:** We are $C\\%$ confident that for every one unit increase in $x_j$, the odds multiply by a factor of $\\exp\\{\\hat{\\beta}_j - z^*\\times SE(\\hat{\\beta}_j)\\}$ to $\\exp\\{\\hat{\\beta}_j + z^* \\times SE(\\hat{\\beta}_j)\\}$, holding all else constant.\n\n## Coefficient for `age` {.midi}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.67309 </td>\n   <td style=\"text-align:right;\"> 0.37815 </td>\n   <td style=\"text-align:right;\"> -17.64688 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> -7.42283 </td>\n   <td style=\"text-align:right;\"> -5.94008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.08246 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00575 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.34353 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.07127 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.09382 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.00200 </td>\n   <td style=\"text-align:right;\"> 0.00103 </td>\n   <td style=\"text-align:right;\"> 1.94024 </td>\n   <td style=\"text-align:right;\"> 0.05235 </td>\n   <td style=\"text-align:right;\"> -0.00003 </td>\n   <td style=\"text-align:right;\"> 0.00401 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.44298 </td>\n   <td style=\"text-align:right;\"> 0.09359 </td>\n   <td style=\"text-align:right;\"> 4.73305 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 0.25998 </td>\n   <td style=\"text-align:right;\"> 0.62699 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n. . .\n\n**Hypotheses:**\n\n$$\nH_0: \\beta_{age} = 0 \\hspace{2mm} \\text{ vs } \\hspace{2mm} H_a: \\beta_{age} \\neq 0\n$$, given total cholesterol and current smoker is in the model\n\n## Coefficient for `age` {.midi}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.67309 </td>\n   <td style=\"text-align:right;\"> 0.37815 </td>\n   <td style=\"text-align:right;\"> -17.64688 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> -7.42283 </td>\n   <td style=\"text-align:right;\"> -5.94008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.08246 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00575 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.34353 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.07127 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.09382 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.00200 </td>\n   <td style=\"text-align:right;\"> 0.00103 </td>\n   <td style=\"text-align:right;\"> 1.94024 </td>\n   <td style=\"text-align:right;\"> 0.05235 </td>\n   <td style=\"text-align:right;\"> -0.00003 </td>\n   <td style=\"text-align:right;\"> 0.00401 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.44298 </td>\n   <td style=\"text-align:right;\"> 0.09359 </td>\n   <td style=\"text-align:right;\"> 4.73305 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 0.25998 </td>\n   <td style=\"text-align:right;\"> 0.62699 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n**Test statistic:**\n\n$$z = \\frac{0.08246 - 0}{0.00575} = 14.34\n$$\n\n## Coefficient for `age` {.midi}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.67309 </td>\n   <td style=\"text-align:right;\"> 0.37815 </td>\n   <td style=\"text-align:right;\"> -17.64688 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> -7.42283 </td>\n   <td style=\"text-align:right;\"> -5.94008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.08246 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00575 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.34353 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.07127 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.09382 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.00200 </td>\n   <td style=\"text-align:right;\"> 0.00103 </td>\n   <td style=\"text-align:right;\"> 1.94024 </td>\n   <td style=\"text-align:right;\"> 0.05235 </td>\n   <td style=\"text-align:right;\"> -0.00003 </td>\n   <td style=\"text-align:right;\"> 0.00401 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.44298 </td>\n   <td style=\"text-align:right;\"> 0.09359 </td>\n   <td style=\"text-align:right;\"> 4.73305 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 0.25998 </td>\n   <td style=\"text-align:right;\"> 0.62699 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n**P-value:**\n\n$$\nP(|Z| > |14.34|) \\approx 0\n$$\n\n. . .\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n2 * pnorm(14.34,lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.230554e-46\n```\n\n\n:::\n:::\n\n\n\n\n## Coefficient for `age` {.midi}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.67309 </td>\n   <td style=\"text-align:right;\"> 0.37815 </td>\n   <td style=\"text-align:right;\"> -17.64688 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> -7.42283 </td>\n   <td style=\"text-align:right;\"> -5.94008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.08246 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00575 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.34353 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.07127 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.09382 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.00200 </td>\n   <td style=\"text-align:right;\"> 0.00103 </td>\n   <td style=\"text-align:right;\"> 1.94024 </td>\n   <td style=\"text-align:right;\"> 0.05235 </td>\n   <td style=\"text-align:right;\"> -0.00003 </td>\n   <td style=\"text-align:right;\"> 0.00401 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.44298 </td>\n   <td style=\"text-align:right;\"> 0.09359 </td>\n   <td style=\"text-align:right;\"> 4.73305 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 0.25998 </td>\n   <td style=\"text-align:right;\"> 0.62699 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n**Conclusion:**\n\nThe p-value is very small, so we reject $H_0$. The data provide sufficient evidence that age is a statistically significant predictor of whether someone is high risk of having heart disease, after accounting for education.\n\n## CI for `age`\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n   <th style=\"text-align:right;\"> conf.low </th>\n   <th style=\"text-align:right;\"> conf.high </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -6.673 </td>\n   <td style=\"text-align:right;\"> 0.378 </td>\n   <td style=\"text-align:right;\"> -17.647 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> -7.423 </td>\n   <td style=\"text-align:right;\"> -5.940 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> age </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.082 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.006 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 14.344 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.000 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.071 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.094 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> totChol </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 1.940 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> currentSmoker1 </td>\n   <td style=\"text-align:right;\"> 0.443 </td>\n   <td style=\"text-align:right;\"> 0.094 </td>\n   <td style=\"text-align:right;\"> 4.733 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 0.260 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n::: question\nInterpret the 95% confidence interval for `age` in terms of the **odds** of being high risk for heart disease.\n:::\n\n## Recap \n\n-   Comparing logistic regression models using\n\n    -   Drop-in-deviance test\n\n    -   AIC\n\n    -   BIC\n\n-   Inference for a single model coefficient\n",
    "supporting": [
      "20-logistic-inference_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}