{
  "hash": "37de0565e25f9a96424eacf2be20f70b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 04: Maximum Likelihood Estimation\"\nformat: html\n---\n\n\n\n::: callout-important\n## Date due\n\n-   Add dates\n-   Add dates\n:::\n\n# Maximum Likelihood Estimation\n\nIn this lab, we will see how a standard simple linear regression analysis can be interpreted as a maximum likelihood estimation procedure.\n\n## Packages\n\nFor today's lab, we will be using the following packages.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\n```\n:::\n\n\n\n## Data\n\n\\[Add introduction about the penguins data set\\]\n\n## Exercises\n\n**The goal is to use bill length and island to understand variability in bill depth.**\n\n### Exercise 1\n\nVisualize the relationship between the response variable and each of the predictors. Use the visualizations to describe the relationship between the response and each predictor.\n\n### Exercise 2\n\nWe wish to fit a model using the bill length, island, and the interaction between the two variables to understand variability in the bill depth.\n\n-   Write the form of the statistical (population-level) model in matrix form.\n\n-   Write the dimensions for $\\mathbf{y}, \\mathbf{X}, \\boldsymbol{\\beta}, \\sigma^2_{\\epsilon}$ specific for this problem.\n\n### Exercise 3\n\nConsider the regression model described in **Exercise 2**.\n\n-   Write down the form of the likelihood function $L(\\boldsymbol{\\beta}, \\sigma^2_{\\epsilon} | \\mathbf{y}, \\mathbf{X})$ in matrix form.\n\n-   Describe how each of the four model assumptions is necessary for the likelihood function.\n\n### Exercise 4\n\nBriefly explain how maximum likelihood estimation for the likelihood function in the previous exercise is related to least-squares estimation for the model in Exercise 2.\n\n### Exercise 5\n\nFor the next few exercises, we will compare the results of the maximum likelihood and least-squares procedures.\n\n-   Fit the regression model corresponding to the statistical model in Exercise 2. Neatly display the results using three digits.\n\n-   Describe the estimated effect of bill length on bill depth, including whether there is statistical evidence of a difference in the effect by island.\n\n### Exercise 6\n\n-   Use matrix/vector operations to compute the maximum likelihood estimators $\\tilde{\\beta}$ for the model in Exercise 2.\n\n-   How do these estimators compare to the least-squares estimators in the previous exercise?\n\n### Exercise 7\n\nThe maximum likelihood estimation procedure also produces an estimator for the variance about the regression line, $\\sigma^2_\\epsilon$, which we can write as\n\n$$\n\\tilde{\\sigma}^2_{\\epsilon} = \\frac{1}{n} \\mathbf{e}^T\\mathbf{e}\n$$\n\nWe know that the maximum likelihood estimate and least-squares estimates for $\\sigma^2_{\\epsilon}$ are not equal. Additionally, the least-squares estimator $\\hat{\\sigma}^2_{\\epsilon}$ is unbiased. We want to find a scaling factor $c$ such that the maximum likelihood estimator is unbiased.\n\nUsing the data and regression estimates from `penguins`, compute both estimators for $\\sigma_{\\epsilon}^2$, and then find $c$ by solving the equation $$ \\hat\\sigma^2_{\\epsilon} = c \\cdot \\tilde\\sigma^2_{\\epsilon} $$ You can do this last step either computationally or algebraically.\n\n### Exercise 8\n\nNow we will look into the last property of the maximum likelihood estimator for $\\boldsymbol{\\beta}$, and thus of least-squares estimates - their **asymptotic normality**.\n\nIn words, this property says that, when the number of samples $n$ is large compared to the number of predictors $p$, the ML estimator $\\hat{\\boldsymbol\\beta}$ follows a multivariate normal distribution $\\mathsf{N}\\big(\\boldsymbol\\beta, \\sigma_\\epsilon^2 (\\mathbf{X}^\\top\\mathbf{X})^{-1}\\big)$. Let's use this to construct an approximate confidence interval for $\\beta_j$, the coefficient for `islandDream`.\n\nUse $\\tilde{\\sigma}^2_{\\epsilon}$, the maximum likelihood estimator, to compute the approximate confidence interval for $\\beta_j$ . The approximate confidence interval may be computed as\n\n$\\tilde{\\beta}_j\\pm 2 \\times SE(\\tilde{\\beta}_j)$\n\n### Exercise 9\n\nCompute the exact (based on the $t$-distribution) confidence interval for $\\beta_1$, then compare the center and width of the this exact interval with the one you computed in **Exercise 8**. Do they differ? By how much? Which one is wider, indicating more uncertainty?\n\n### Exercise 10\n\nTo wrap up, we have seen that both the OLS and the ML procedures for linear regression produce the same coefficient estimates, but lead to different estimators for the variance $\\sigma_\\epsilon^2$ and allow for different types of uncertainty quantification.\n\nBased on the work in this lab, do you think performing inference based on either method would have changed your conclusions about the difference (or lack thereof) in the relationship between bill depth and bill length by island?\n\n# Submission \n\n# Grading\n",
    "supporting": [
      "lab-04-draft_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}